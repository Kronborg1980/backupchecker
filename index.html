<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KRONBORG: CRYSTAL ORACLE v10.0</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&family=Orbitron:wght@500;700&display=swap');

    :root {
      --bg-dark: #050508;
      --neon-cyan: #00fff2;
      --neon-pink: #ff00d4;
      --neon-green: #00ff9d;
      --glass-bg: rgba(255, 255, 255, 0.03);
      --glass-border: rgba(255, 255, 255, 0.1);
      --text-bright: #ffffff;
      --text-dim: #a1a1b5;
    }

    * { box-sizing: border-box; outline: none; }

    body {
      margin: 0;
      font-family: 'Outfit', sans-serif;
      background-color: var(--bg-dark);
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(0, 255, 242, 0.1) 0%, transparent 40%),
        radial-gradient(circle at 90% 80%, rgba(255, 0, 212, 0.1) 0%, transparent 40%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 30px;
      color: var(--text-bright);
    }
    
    /* Background Drift */
    body::before {
        content: ''; position: fixed; top: -50%; left: -50%; width: 200%; height: 200%;
        background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='a'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.005' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23a)' opacity='0.04'/%3E%3C/svg%3E");
        opacity: 0.3; z-index: -1; animation: drift 100s linear infinite;
    }
    @keyframes drift { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* --- GLASS CHASSIS --- */
    .glass-container {
      width: 100%;
      max-width: 600px;
      background: var(--glass-bg);
      backdrop-filter: blur(30px) saturate(160%);
      -webkit-backdrop-filter: blur(30px) saturate(160%);
      border: 1px solid var(--glass-border);
      border-radius: 40px;
      box-shadow: 0 30px 60px rgba(0,0,0,0.6), inset 0 0 20px rgba(255, 255, 255, 0.02);
      padding: 35px;
      display: flex;
      flex-direction: column;
      gap: 25px;
    }

    /* HEADER */
    .header { display: flex; justify-content: space-between; align-items: center; }
    .title-block h1 {
      font-family: 'Orbitron'; font-size: 24px; margin: 0;
      background: linear-gradient(90deg, #fff, var(--neon-cyan));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      filter: drop-shadow(0 0 5px rgba(0, 255, 242, 0.3));
    }
    .title-block span { font-size: 11px; color: var(--text-dim); letter-spacing: 2px; text-transform: uppercase; }

    .cubone-orb {
      width: 50px; height: 50px;
      background: rgba(0,0,0,0.3) url('https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/104.png') no-repeat center/cover;
      border-radius: 50%; border: 2px solid rgba(255,255,255,0.1);
      box-shadow: 0 0 15px rgba(255, 0, 212, 0.3);
    }

    /* --- INTELLIGENT MONITOR --- */
    .monitor-panel {
      background: rgba(0,0,0,0.25);
      border-radius: 30px;
      padding: 20px;
      display: flex; align-items: center; gap: 20px;
      border: 1px solid rgba(255,255,255,0.05);
      position: relative; overflow: hidden;
    }

    .radar-ring {
        width: 100px; height: 100px;
        border-radius: 50%;
        border: 4px solid rgba(255, 255, 255, 0.05);
        display: flex; justify-content: center; align-items: center;
        position: relative; transition: 0.5s;
    }
    .radar-ring.scanning { border-color: var(--neon-cyan); box-shadow: 0 0 30px var(--neon-cyan); animation: pulse 2s infinite; }
    .radar-ring.safe { border-color: var(--neon-green); box-shadow: 0 0 30px var(--neon-green); }
    .radar-ring.danger { border-color: var(--neon-pink); box-shadow: 0 0 40px var(--neon-pink); animation: shake 0.5s infinite; }

    @keyframes pulse { 0% { box-shadow: 0 0 10px var(--neon-cyan); } 50% { box-shadow: 0 0 30px var(--neon-cyan); } 100% { box-shadow: 0 0 10px var(--neon-cyan); } }
    @keyframes shake { 0% { transform: translate(1px, 1px); } 50% { transform: translate(-1px, -1px); } 100% { transform: translate(1px, -1px); } }

    .magikarp { width: 70px; height: 70px; background: url('https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/129.png') no-repeat center/cover; image-rendering: pixelated; transition: 0.3s; }
    .radar-ring.scanning .magikarp { animation: float 2s infinite ease-in-out; }
    .radar-ring.safe .magikarp { transform: scale(1.1); filter: drop-shadow(0 0 5px var(--neon-green)); }
    @keyframes float { 0% { transform: translateY(0); } 50% { transform: translateY(-8px); } 100% { transform: translateY(0); } }

    /* Text Info */
    .status-info { flex: 1; display: flex; flex-direction: column; justify-content: center; }
    .lbl-main { font-size: 12px; color: var(--text-dim); letter-spacing: 1px; margin-bottom: 2px; }
    
    .val-status { 
      font-family: 'Orbitron'; font-size: 24px; color: #fff; margin-bottom: 4px;
      text-shadow: 0 0 10px rgba(255,255,255,0.1); transition: 0.3s;
    }
    
    .val-countdown { font-family: monospace; font-size: 13px; color: var(--neon-cyan); opacity: 0; transition: 0.3s; }
    .val-log { font-size: 11px; color: #888; margin-top: 4px; font-style: italic; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }

    /* --- INPUT SECTIONS --- */
    .glass-card {
      background: rgba(255, 255, 255, 0.02);
      border-radius: 25px; padding: 20px;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }
    .card-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; color: #fff; font-size: 14px; font-weight: 500; }

    /* Inputs */
    .capsule {
      display: flex; align-items: center;
      background: rgba(0,0,0,0.3); border-radius: 50px;
      border: 1px solid rgba(255,255,255,0.1);
      padding: 6px 12px 6px 20px; margin-bottom: 8px;
    }
    .capsule:focus-within { border-color: var(--neon-cyan); background: rgba(0,0,0,0.5); }
    .c-icon { margin-right: 10px; color: var(--text-dim); font-size: 12px; }
    input[type="text"] { flex: 1; background: none; border: none; color: #fff; font-family: 'Outfit'; font-size: 14px; }
    .btn-del { width: 28px; height: 28px; border-radius: 50%; background: rgba(255,255,255,0.1); border:none; color:#fff; cursor: pointer; display: flex; justify-content: center; align-items: center; transition: 0.2s; }
    .btn-del:hover { background: var(--neon-pink); }
    
    .add-link { background: none; border: none; color: var(--text-dim); font-size: 12px; cursor: pointer; padding: 0; margin-top: 5px; }
    .add-link:hover { color: var(--neon-cyan); }

    /* Toggle & Slider */
    .toggle { appearance: none; width: 40px; height: 22px; background: rgba(0,0,0,0.5); border-radius: 20px; position: relative; cursor: pointer; border: 1px solid rgba(255,255,255,0.2); transition: 0.3s; }
    .toggle::after { content:''; position: absolute; top: 2px; left: 2px; width: 16px; height: 16px; background: #fff; border-radius: 50%; transition: 0.3s; }
    .toggle:checked { background: var(--neon-cyan); border-color: var(--neon-cyan); }
    .toggle:checked::after { transform: translateX(18px); }

    input[type=range] { width: 100%; height: 6px; border-radius: 10px; background: rgba(0,0,0,0.5); accent-color: var(--neon-cyan); margin-top: 10px; }

    /* Buttons */
    .btn-main {
      width: 100%; padding: 18px; border-radius: 50px; border: none;
      font-family: 'Orbitron'; font-size: 16px; font-weight: 700; letter-spacing: 2px;
      background: linear-gradient(90deg, var(--neon-cyan), #00aaff); color: #000;
      cursor: pointer; transition: 0.3s; box-shadow: 0 0 30px rgba(0, 255, 242, 0.2);
    }
    .btn-main:hover { transform: scale(1.02); box-shadow: 0 0 50px rgba(0, 255, 242, 0.4); }

    .btn-stop { display: none; background: linear-gradient(90deg, var(--neon-pink), #ff0055); color: #fff; box-shadow: 0 0 30px rgba(255, 0, 85, 0.2); }
    .btn-stop:hover { box-shadow: 0 0 50px rgba(255, 0, 85, 0.4); }

    /* Bottom Log */
    .log-feed {
      height: 100px; background: rgba(0,0,0,0.3); border-radius: 20px; padding: 15px;
      font-family: monospace; font-size: 11px; overflow-y: auto;
      display: flex; flex-direction: column-reverse; border: 1px solid rgba(255,255,255,0.05);
    }
    .log-row { margin-bottom: 3px; }
    .c-green { color: var(--neon-green); } .c-red { color: var(--neon-pink); } .c-blue { color: var(--neon-cyan); }

  </style>
</head>
<body>

  <div class="glass-container">
    
    <div class="header">
      <div class="title-block">
        <h1>KRONBORG</h1>
        <span>CRYSTAL ORACLE v10.0</span>
      </div>
      <div class="cubone-orb" title="System Guardian"></div>
    </div>

    <div class="monitor-panel">
      <div class="radar-ring" id="radar">
        <div class="magikarp"></div>
      </div>
      <div class="status-info">
        <div class="lbl-main">ORACLE STATUS</div>
        <div class="val-status" id="statusMain">OFFLINE</div>
        <div class="val-log" id="statusLog">Waiting for start command...</div>
        <div class="val-countdown" id="nextScanTimer">Next Scan: --s</div>
      </div>
    </div>

    <div class="glass-card">
      <div class="card-head">
        <span>Email Alerts</span>
        <input type="checkbox" class="toggle" id="emailToggle" checked>
      </div>
      <div id="emailList"></div>
      <button class="add-link" onclick="addEmail()">+ Add Recipient</button>
    </div>

    <div class="glass-card">
      <div class="card-head">
        <span>Discord Webhooks</span>
        <input type="checkbox" class="toggle" id="discordToggle" checked>
      </div>
      <div id="discordList"></div>
      <div style="display:flex; justify-content:space-between;">
        <button class="add-link" onclick="addDiscord()">+ Add Webhook</button>
        <button class="add-link" style="color:var(--neon-pink)" onclick="addPokezonan()">Load Preset</button>
      </div>
    </div>

    <div class="glass-card" style="padding: 15px 25px;">
      <div class="card-head" style="margin-bottom: 5px;">
        <span>Scan Interval</span>
        <span style="color:var(--neon-cyan); font-family:'Orbitron'" id="freqVal">10m</span>
      </div>
      <input type="range" id="freqSlider" min="1" max="60" value="10" oninput="updFreq(this.value)">
    </div>

    <button id="btnStart" class="btn-main" onclick="toggleSys(true)">INITIALIZE ORACLE</button>
    <button id="btnStop" class="btn-main btn-stop" onclick="toggleSys(false)">TERMINATE</button>

    <div class="log-feed" id="fullLog">
      <div class="log-row">System ready.</div>
    </div>

    <div style="text-align:center;">
       <button class="add-link" style="text-decoration:underline" onclick="test()">Run Alert Test</button>
    </div>

  </div>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4.4.1/dist/email.min.js"></script>
<script>
    const C = { t: "https://www.pokemoncenter.com/category/trading-card-game", k: "8w7eu6mrg3lRl6ta3" };
    let run = false, scanT = null, countT = null, nextScanTime = 0;

    if(window.emailjs) emailjs.init({publicKey:C.k});
    window.onload = () => { load(); if(!g('emailList').children.length)addEmail(); if(!g('discordList').children.length)addDiscord(); };
    function g(id){ return document.getElementById(id); }

    // --- UI Updaters ---
    function updFreq(v){ g('freqVal').innerText = v+"m"; save(); }
    function setStatus(txt, color, logTxt, ringClass) {
        const s = g('statusMain'), l = g('statusLog'), r = g('radar');
        s.innerText = txt;
        s.style.color = color;
        s.style.textShadow = `0 0 15px ${color}`;
        l.innerText = logTxt;
        r.className = 'radar-ring ' + ringClass;
    }

    // --- Components ---
    function mkCap(v,i,p,t){
        const d=document.createElement('div'); d.className='capsule';
        d.innerHTML=`<span class="c-icon">${i}</span><input type="${t}" value="${v}" placeholder="${p}" onchange="save()"><button class="btn-del" onclick="this.parentElement.remove();save()">Ã—</button>`;
        return d;
    }
    function addEmail(v=''){ g('emailList').appendChild(mkCap(v,'@','email...', 'email')); }
    function addDiscord(v=''){ g('discordList').appendChild(mkCap(v,'#','url...', 'url')); }
    function addPokezonan(){ addDiscord("https://discord.com/api/webhooks/1418654823745716436/vuMKu1s095Cq3BfU06OF_Z_mwxG39zHppHJ3c4BX5X38WuJFWPGhIZdopWTEEXlophiN"); save(); }

    // --- Logic ---
    function log(m, c=''){ 
        const d=g('fullLog'), r=document.createElement('div'); r.className='log-row '+c;
        r.innerText = `[${new Date().toLocaleTimeString([],{hour12:false})}] ${m}`; d.insertBefore(r, d.firstChild);
    }
    function save(){
        const d = {
            es: Array.from(g('emailList').querySelectorAll('input')).map(i=>i.value),
            ws: Array.from(g('discordList').querySelectorAll('input')).map(i=>i.value),
            eo: g('emailToggle').checked, do: g('discordToggle').checked, fr: g('freqSlider').value
        }; localStorage.setItem('k10_cfg', JSON.stringify(d));
    }
    function load(){
        const d = JSON.parse(localStorage.getItem('k10_cfg')); if(!d)return;
        d.es.forEach(e=>addEmail(e)); d.ws.forEach(w=>addDiscord(w));
        g('emailToggle').checked=d.eo; g('discordToggle').checked=d.do; g('freqSlider').value=d.fr; updFreq(d.fr);
    }

    function toggleSys(on) {
        run = on;
        const b1=g('btnStart'), b2=g('btnStop'), tm=g('nextScanTimer');
        if(on) {
            b1.style.display='none'; b2.style.display='block'; tm.style.opacity=1;
            setStatus("INITIALIZING", "var(--neon-cyan)", "Booting proxy mesh...", "scanning");
            log("System started.", "c-blue");
            loop();
        } else {
            b1.style.display='block'; b2.style.display='none'; tm.style.opacity=0;
            setStatus("OFFLINE", "#fff", "System Halted", "");
            clearTimeout(scanT); clearInterval(countT);
            log("System stopped.", "c-red");
        }
    }

    async function loop() {
        if(!run) return;

        // 1. Update Status to Scanning
        setStatus("SCANNING...", "var(--neon-cyan)", "Pinging target via proxies...", "scanning");
        g('nextScanTimer').innerText = "Scanning now...";
        
        // 2. Perform Check
        const ts = Date.now();
        const enc = encodeURIComponent(C.t + `?z=${ts}`);
        const proxies = [`https://api.allorigins.win/raw?url=${enc}`, `https://corsproxy.io/?${enc}`];
        
        let html = "", url = "";
        
        for(const p of proxies) {
            try {
                const c = new AbortController(); setTimeout(()=>c.abort(), 10000);
                const r = await fetch(p, {signal:c.signal});
                if(r.ok) {
                    html = (await r.text()).toLowerCase();
                    url = r.url;
                    break;
                }
            } catch(e){}
        }

        // 3. Analyze & Update Status
        if(!html) {
            setStatus("NET ERROR", "var(--neon-pink)", "Proxies failed. Retrying.", "danger");
            log("Connection failed.", "c-red");
        } else {
            analyze(html, url);
        }

        // 4. Schedule Next
        const mins = parseInt(g('freqSlider').value);
        const delay = (mins * 60000) + Math.floor(Math.random() * 60000); // 0-60s jitter
        nextScanTime = Date.now() + delay;
        
        // Start Countdown UI
        clearInterval(countT);
        countT = setInterval(() => {
            const left = Math.max(0, Math.ceil((nextScanTime - Date.now()) / 1000));
            g('nextScanTimer').innerText = `Next Scan: ${left}s`;
            if(left <= 0) clearInterval(countT);
        }, 1000);

        scanT = setTimeout(loop, delay);
    }

    function analyze(h, u) {
        if(u.includes("queue-it") || h.includes("users in line")) {
            setStatus("QUEUE FOUND", "var(--neon-pink)", "Redirect detected!", "danger");
            log("QUEUE DETECTED!", "c-red");
            notify("QUEUE ALERT", "You are in a queue!", "red");
            beep();
        } else if(h.includes("add to cart") || h.includes("trading card game")) {
            setStatus("NO QUEUE", "var(--neon-green)", "Shop accessible. 200 OK.", "safe");
            log("Shop accessible. No queue.", "c-green");
        } else if(h.includes("cloudflare")) {
            setStatus("WAF BLOCK", "#fff", "Soft-Block. Retrying.", "");
            log("Cloudflare WAF detected.", "");
        } else {
            setStatus("NO QUEUE", "var(--neon-green)", "Site reachable. No keywords.", "safe");
            log("Check complete. Clean.", "c-green");
        }
    }

    function notify(t, m, c) {
        if(g('discordToggle').checked) {
            const cl = c==='red'?15548997:5763719;
            Array.from(g('discordList').querySelectorAll('input')).map(i=>i.value).filter(v=>v.includes('http'))
            .forEach(u=>fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeds:[{title:`ðŸš¨ ${t}`,description:m,color:cl}]})}).catch(()=>{}));
        }
        if(g('emailToggle').checked) {
            Array.from(g('emailList').querySelectorAll('input')).map(i=>i.value).filter(v=>v.includes('@'))
            .forEach(e=>emailjs.send("service_ahqdaj5","template_whhvnra",{status:t,details:m,to_email:e}));
        }
    }

    function test() { notify("TEST", "System Check OK", "green"); log("Test sent.", "c-blue"); beep(); }
    const ac=new(window.AudioContext||window.webkitAudioContext)();
    function beep(){ if(ac.state==='suspended')ac.resume(); const o=ac.createOscillator(),g=ac.createGain(); o.connect(g); g.connect(ac.destination); o.type='square';o.frequency.value=600;g.gain.value=0.1; o.start();o.stop(ac.currentTime+0.2); }
</script>
</body>
</html>
