<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KRONBORG: PROTOCOL MAGIKARP</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@500;700&display=swap');

    :root {
      --bg-dark: #050505;
      --glass: rgba(20, 20, 35, 0.85);
      --neon-blue: #00f3ff;
      --neon-red: #ff0055;
      --neon-gold: #ffd700;
      --magikarp-orange: #ff5e00;
      --cubone-bone: #e3e3d8;
    }

    * { box-sizing: border-box; outline: none; user-select: none; }

    body {
      margin: 0;
      font-family: 'Rajdhani', sans-serif;
      background-color: var(--bg-dark);
      background-image: 
        linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
      background-size: 30px 30px;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      overflow: hidden;
    }

    /* Main Chassis */
    .pokedex-container {
      width: 100%;
      max-width: 420px;
      background: var(--glass);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      backdrop-filter: blur(20px);
      box-shadow: 
        0 0 40px rgba(0, 243, 255, 0.1),
        inset 0 0 20px rgba(0, 0, 0, 0.8);
      position: relative;
      overflow: hidden;
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }

    /* Decorative Top Bar */
    .top-bar {
      height: 6px;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-red));
      width: 100%;
    }

    /* Header with Cubone */
    .header {
      padding: 20px 25px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .title-group h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 22px;
      margin: 0;
      background: linear-gradient(to right, #fff, var(--neon-blue));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .cubone-icon {
      width: 50px;
      height: 50px;
      background-image: url('https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/104.png');
      background-size: cover;
      filter: drop-shadow(0 0 5px var(--cubone-bone));
      opacity: 0.8;
    }

    /* Radar / Magikarp Section */
    .radar-section {
      display: flex;
      justify-content: center;
      padding: 20px 0;
      position: relative;
    }

    .radar-circle {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 2px dashed rgba(255, 255, 255, 0.2);
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      background: radial-gradient(circle, rgba(0, 243, 255, 0.1), transparent);
      transition: 0.3s;
    }

    .radar-circle.active {
      border-color: var(--neon-blue);
      box-shadow: 0 0 30px var(--neon-blue);
      animation: spinBorder 4s linear infinite;
    }

    .magikarp {
      width: 80px;
      height: 80px;
      background-image: url('https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/129.png');
      background-size: cover;
      image-rendering: pixelated;
      transition: 0.3s;
    }

    .radar-circle.active .magikarp {
      animation: splash 0.5s infinite;
    }

    @keyframes splash {
      0% { transform: rotate(0deg) translateY(0); }
      25% { transform: rotate(-15deg) translateY(-10px); }
      50% { transform: rotate(0deg) translateY(0); }
      75% { transform: rotate(15deg) translateY(-5px); }
      100% { transform: rotate(0deg) translateY(0); }
    }

    @keyframes spinBorder { 100% { transform: rotate(360deg); } }

    /* Status Text */
    .status-display {
      text-align: center;
      font-family: 'Orbitron', monospace;
      margin-bottom: 20px;
    }
    .status-main { font-size: 14px; letter-spacing: 1px; color: #888; }
    .status-timer { font-size: 12px; color: var(--neon-blue); margin-top: 5px; opacity: 0; transition: 0.3s; }
    .status-timer.show { opacity: 1; }

    /* Content Form */
    .content { padding: 0 25px 25px; }

    /* Panels */
    .panel {
      background: rgba(0, 0, 0, 0.4);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 12px;
      border-left: 3px solid rgba(255, 255, 255, 0.1);
      transition: 0.3s;
    }
    .panel:hover { border-left-color: var(--neon-blue); background: rgba(0, 0, 0, 0.6); }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }
    .panel-title { font-size: 14px; font-weight: 700; color: #ccc; display: flex; align-items: center; gap: 8px; }

    /* Toggles */
    .toggle-switch {
      position: relative;
      width: 40px; height: 20px;
      appearance: none;
      background: #333;
      border-radius: 20px;
      cursor: pointer;
      transition: 0.3s;
    }
    .toggle-switch::after {
      content: '';
      position: absolute;
      top: 2px; left: 2px;
      width: 16px; height: 16px;
      background: #888;
      border-radius: 50%;
      transition: 0.3s;
    }
    .toggle-switch:checked { background: var(--magikarp-orange); box-shadow: 0 0 10px var(--magikarp-orange); }
    .toggle-switch:checked::after { transform: translateX(20px); background: #fff; }

    /* Inputs */
    .hidden-list {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease;
    }
    .hidden-list.open { max-height: 150px; overflow-y: auto; margin-top: 10px; }
    
    .input-row { display: flex; gap: 5px; margin-bottom: 5px; }
    
    input[type="text"] {
      width: 100%;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      color: var(--neon-blue);
      padding: 8px 12px;
      border-radius: 6px;
      font-family: 'Rajdhani', sans-serif;
      font-size: 14px;
    }
    input::placeholder { color: #444; }

    .btn-icon {
      background: transparent; border: 1px solid #444; color: #666;
      border-radius: 6px; width: 32px; cursor: pointer;
    }
    .btn-icon:hover { color: var(--neon-red); border-color: var(--neon-red); }

    .btn-text {
      background: none; border: none; color: #666; font-size: 11px;
      cursor: pointer; text-transform: uppercase; letter-spacing: 1px;
      margin-top: 5px;
    }
    .btn-text:hover { color: var(--neon-blue); }

    /* Slider */
    input[type=range] { width: 100%; height: 4px; background: #333; accent-color: var(--neon-blue); border-radius: 2px; }

    /* Main Button */
    .power-btn {
      width: 100%;
      padding: 18px;
      font-family: 'Orbitron', sans-serif;
      font-weight: 900;
      font-size: 16px;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: #000;
      background: var(--neon-blue);
      border: none;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 0 20px rgba(0, 243, 255, 0.4);
      transition: 0.3s;
      position: relative;
      overflow: hidden;
    }
    .power-btn:hover { transform: scale(1.02); box-shadow: 0 0 40px rgba(0, 243, 255, 0.6); }
    
    .power-btn.stop { background: var(--neon-red); box-shadow: 0 0 20px rgba(255, 0, 85, 0.4); color: #fff; }

    /* Terminal */
    .terminal-window {
      margin-top: 15px;
      height: 100px;
      background: #000;
      border: 1px solid #222;
      border-radius: 8px;
      padding: 10px;
      font-family: monospace;
      font-size: 11px;
      color: #555;
      overflow-y: auto;
      display: flex;
      flex-direction: column-reverse;
    }
    .log-entry { margin-bottom: 2px; }
    .c-success { color: var(--neon-blue); }
    .c-err { color: var(--neon-red); }
    .c-warn { color: var(--magikarp-orange); }

  </style>
</head>
<body>

<div class="pokedex-container">
  <div class="top-bar"></div>
  
  <div class="header">
    <div class="title-group">
      <h1>Kronborg</h1>
      <div style="font-size: 10px; color: #666; letter-spacing: 1px;">TCG CHECKER v6.0</div>
    </div>
    <div class="cubone-icon" title="Guardian Cubone"></div>
  </div>

  <div class="radar-section">
    <div class="radar-circle" id="radar">
      <div class="magikarp"></div>
    </div>
  </div>

  <div class="status-display">
    <div id="statusText" class="status-main">SYSTEM IDLE</div>
    <div id="timerDisplay" class="status-timer">RUNTIME: 00:00:00</div>
  </div>

  <div class="content">
    
    <div class="panel">
      <div class="panel-header">
        <span class="panel-title">üì° ALERTS</span>
      </div>
      
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
        <span style="font-size:12px; color:#888;">EMAIL</span>
        <input type="checkbox" class="toggle-switch" id="toggleEmail" checked>
      </div>
      <div class="hidden-list" id="emailList">
        </div>
      <button class="btn-text" onclick="addEmailRow()">+ Add Email</button>
      <button class="btn-text" style="float:right" onclick="toggleView('emailList')">Edit List</button>

      <div style="height:1px; background:#333; margin:10px 0;"></div>

      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
        <span style="font-size:12px; color:#888;">DISCORD</span>
        <input type="checkbox" class="toggle-switch" id="toggleDiscord" checked>
      </div>
      <div class="hidden-list" id="discordList">
        </div>
      <button class="btn-text" onclick="addWebhookRow()">+ Add Webhook</button>
      <button class="btn-text" style="float:right" onclick="toggleView('discordList')">Edit List</button>
      <div style="text-align:center; margin-top:5px;">
        <button class="btn-text" style="color:var(--neon-blue)" onclick="addPokezonan()">‚ö° LOAD POKEZONAN PRESET</button>
      </div>
    </div>

    <div class="panel">
      <div class="panel-header">
        <span class="panel-title">‚è±Ô∏è SCAN INTERVAL</span>
        <span id="freqValue" style="font-family:'Orbitron'; color:var(--neon-blue)">10m</span>
      </div>
      <input type="range" id="freqSlider" min="1" max="60" value="10" oninput="updateFreq(this.value)">
      <div style="font-size:10px; color:#555; margin-top:5px; text-align:right;">+ Random Stealth Jitter</div>
    </div>

    <button id="btnStart" class="power-btn" onclick="toggleSystem(true)">INITIALIZE</button>
    <button id="btnStop" class="power-btn stop" style="display:none;" onclick="toggleSystem(false)">TERMINATE</button>

    <div class="terminal-window" id="terminal">
      <div class="log-entry">Waiting for command...</div>
    </div>
    
    <div style="text-align:center; margin-top:10px;">
        <button class="btn-text" onclick="testAlerts()">[ TEST ALERT SYSTEMS ]</button>
    </div>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4.4.1/dist/email.min.js"></script>
<script>
    // --- CONFIG ---
    const TARGET = "https://www.pokemoncenter.com/category/trading-card-game";
    const EMAIL_KEY = "8w7eu6mrg3lRl6ta3";
    
    let running = false;
    let timerRef = null;
    let clockRef = null;
    let startTime = 0;

    // Init EmailJS
    if(window.emailjs) emailjs.init({ publicKey: EMAIL_KEY });

    // --- SETUP ON LOAD ---
    window.onload = () => {
        loadSettings();
        if(document.getElementById('emailList').children.length === 0) addEmailRow();
        if(document.getElementById('discordList').children.length === 0) addWebhookRow();
    };

    // --- UI FUNCTIONS ---
    function updateFreq(val) { document.getElementById('freqValue').innerText = val + "m"; }
    
    function toggleView(id) {
        const el = document.getElementById(id);
        el.classList.toggle('open');
    }

    function createInput(val, placeholder, type) {
        const div = document.createElement('div');
        div.className = 'input-row';
        div.innerHTML = `<input type="${type}" value="${val}" placeholder="${placeholder}" onchange="saveSettings()"><button class="btn-icon" onclick="this.parentElement.remove(); saveSettings();">√ó</button>`;
        return div;
    }

    function addEmailRow(val='') {
        document.getElementById('emailList').appendChild(createInput(val, 'email@ex.com', 'email'));
        document.getElementById('emailList').classList.add('open');
    }

    function addWebhookRow(val='') {
        document.getElementById('discordList').appendChild(createInput(val, 'https://discord...', 'url'));
        document.getElementById('discordList').classList.add('open');
    }

    function addPokezonan() {
        addWebhookRow("https://discord.com/api/webhooks/1418654823745716436/vuMKu1s095Cq3BfU06OF_Z_mwxG39zHppHJ3c4BX5X38WuJFWPGhIZdopWTEEXlophiN");
        saveSettings();
        log("Preset Loaded.", "c-success");
    }

    function log(msg, cls='') {
        const t = document.getElementById('terminal');
        const time = new Date().toLocaleTimeString([], {hour12:false});
        const d = document.createElement('div');
        d.className = 'log-entry';
        d.innerHTML = `<span style="color:#333">[${time}]</span> <span class="${cls}">${msg}</span>`;
        t.insertBefore(d, t.firstChild);
    }

    // --- STORAGE ---
    function saveSettings() {
        const ems = Array.from(document.getElementById('emailList').querySelectorAll('input')).map(i=>i.value);
        const whs = Array.from(document.getElementById('discordList').querySelectorAll('input')).map(i=>i.value);
        localStorage.setItem('k6_emails', JSON.stringify(ems));
        localStorage.setItem('k6_hooks', JSON.stringify(whs));
    }

    function loadSettings() {
        const ems = JSON.parse(localStorage.getItem('k6_emails') || '[]');
        const whs = JSON.parse(localStorage.getItem('k6_hooks') || '[]');
        ems.forEach(e => addEmailRow(e));
        whs.forEach(w => addWebhookRow(w));
    }

    // --- CORE SYSTEM ---
    function toggleSystem(state) {
        running = state;
        const btnStart = document.getElementById('btnStart');
        const btnStop = document.getElementById('btnStop');
        const radar = document.getElementById('radar');
        const status = document.getElementById('statusText');
        const timeDisp = document.getElementById('timerDisplay');

        if(running) {
            btnStart.style.display = 'none';
            btnStop.style.display = 'block';
            radar.classList.add('active');
            status.innerText = "SCANNING TARGET...";
            status.style.color = "var(--neon-blue)";
            timeDisp.classList.add('show');
            
            startTime = Date.now();
            clockRef = setInterval(() => {
                const d = new Date(Date.now() - startTime);
                timeDisp.innerText = "RUNTIME: " + d.toISOString().substr(11, 8);
            }, 1000);

            log("System Initialized.", "c-success");
            runLoop();
        } else {
            btnStart.style.display = 'block';
            btnStop.style.display = 'none';
            radar.classList.remove('active');
            status.innerText = "SYSTEM IDLE";
            status.style.color = "#888";
            timeDisp.classList.remove('show');
            
            clearTimeout(timerRef);
            clearInterval(clockRef);
            log("System Halted.", "c-err");
        }
    }

    async function runLoop() {
        if(!running) return;

        log("Pinging Proxies...");
        
        // Stealth Logic
        const ts = Date.now();
        const enc = encodeURIComponent(TARGET + `?_=${ts}`);
        const proxies = [
            `https://api.allorigins.win/raw?url=${enc}`,
            `https://corsproxy.io/?${enc}`
        ];

        let content = "";
        
        for(const p of proxies) {
            try {
                const c = new AbortController();
                setTimeout(()=>c.abort(), 15000);
                const r = await fetch(p, {signal: c.signal});
                if(r.ok) {
                    content = (await r.text()).toLowerCase();
                    if(r.url.includes("queue-it")) content += " queue-it";
                    break;
                }
            } catch(e) {}
        }

        if(!content) {
            log("Connection Failed.", "c-err");
        } else {
            analyze(content);
        }

        // Schedule Next
        const mins = parseInt(document.getElementById('freqSlider').value);
        const ms = (mins * 60000) + Math.floor(Math.random() * 40000);
        log(`Next scan in ${Math.floor(ms/1000)}s`);
        timerRef = setTimeout(runLoop, ms);
    }

    function analyze(html) {
        if(html.includes("queue-it") || html.includes("users in line")) {
            log("QUEUE DETECTED!", "c-err");
            sendAlert("QUEUE ALERT", "Queue detected on TCG page.", "red");
            playAlarm();
        } else if(html.includes("add to cart") || html.includes("trading card game")) {
            log("SHOP ACCESSIBLE!", "c-success");
            sendAlert("DROP LIVE", "Shop appears open!", "green");
            playAlarm();
        } else if(html.includes("cloudflare")) {
            log("Soft Block (WAF)", "c-warn");
        } else {
            log("Target Reachable (No Queue)", "c-success");
        }
    }

    function sendAlert(title, msg, colorType) {
        const useEmail = document.getElementById('toggleEmail').checked;
        const useDiscord = document.getElementById('toggleDiscord').checked;

        // Discord
        if(useDiscord) {
            const hooks = Array.from(document.getElementById('discordList').querySelectorAll('input')).map(i=>i.value);
            const color = colorType === 'red' ? 15548997 : 5763719;
            hooks.forEach(h => {
                if(h.includes('http')) {
                    fetch(h, {
                        method:"POST", headers:{"Content-Type":"application/json"},
                        body: JSON.stringify({embeds:[{title:`üö® ${title}`, description:msg, color:color}]})
                    }).catch(()=>{});
                }
            });
        }

        // Email
        if(useEmail) {
            const mails = Array.from(document.getElementById('emailList').querySelectorAll('input')).map(i=>i.value);
            mails.forEach(m => {
                if(m.includes('@')) emailjs.send("service_ahqdaj5", "template_whhvnra", {status: title, details: msg, to_email: m});
            });
        }
    }

    function testAlerts() {
        sendAlert("TEST FIRED", "Magikarp Protocol is active.", "green");
        alert("Test sent! Check Discord/Email.");
    }

    // Audio
    const ac = new (window.AudioContext || window.webkitAudioContext)();
    function playAlarm() {
        if(ac.state==='suspended')ac.resume();
        const o=ac.createOscillator(); const g=ac.createGain();
        o.connect(g); g.connect(ac.destination);
        o.type='sawtooth'; o.frequency.value=440;
        g.gain.value=0.1; o.start(); o.stop(ac.currentTime+0.5);
    }
</script>

</body>
</html>
